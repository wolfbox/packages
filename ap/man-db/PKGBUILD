pkgname=man-db
pkgver=2.7.0.2
pkgrel=1
pkgdesc="Manual page viewer."
arch=("x86_64")
url="http://www.nongnu.org/man-db/"
license=('GPLv2')

depends=('glibc' 'groff' 'gdbm>=1.9.0' 'libpipeline')
makedepends=('pkg-config')

source=(http://download.savannah.gnu.org/releases/man-db/man-db-${pkgver}.tar.xz
        man-db.upstart)
sha256sums=(90b7387eaa7c38e0d188d64cffea5d959bae5a0189327b507835330f48ae990d
            72c0c53580817ec7feadf4847b74d36c39b8499a20304211ac7154746d3cf9de)

build() {
	cd "${srcdir}/${pkgname}-${pkgver}"
	./configure --prefix=/usr --libdir=/usr/lib/${MULTIARCH} \
	            --libexecdir=/usr/lib/${MULTIARCH} --sbindir=/usr/bin \
	            --mandir=/usr/man --docdir=/usr/doc/man-db-${pkgver} \
	            --disable-setuid --with-db=gdbm
	make
}

package() {
	cd "${srcdir}/${pkgname}-${pkgver}"

	make install DESTDIR="${pkgdir}"
	rm "${pkgdir}"/usr/doc/man-db-${pkgver}/*.ps

	mkdir -p "${pkgdir}"/var/cache/man
	mkdir -p "${pkgdir}"/etc/init
	install -m644 "${srcdir}"/man-db.upstart "${pkgdir}"/etc/init/man-db.conf
}
